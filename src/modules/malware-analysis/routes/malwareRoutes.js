/**
 * Malware Analysis API Routes
 */

const express = require('express');
const malwareController = require('../controllers/malwareController');

const router = express.Router();

// Submission endpoints
router.post('/submit', malwareController.submitSample);
router.get('/submissions', malwareController.getSubmissions);
router.get('/submissions/:id', malwareController.getSubmissionById);
router.get('/queue/stats', malwareController.getQueueStats);

// Static analysis endpoints
router.post('/:id/static-analysis', malwareController.performStaticAnalysis);
router.get('/:id/static-analysis', malwareController.getStaticAnalysis);

// Dynamic analysis endpoints
router.post('/:id/dynamic-analysis', malwareController.performDynamicAnalysis);
router.get('/:id/dynamic-analysis', malwareController.getDynamicAnalysis);

// Behavioral analysis endpoints
router.get('/:id/behavior', malwareController.getBehavioralAnalysis);
router.get('/:id/report', malwareController.generateReport);

// Classification endpoints
router.post('/classify', malwareController.classifySample);
router.get('/:id/family', malwareController.getClassification);
router.post('/:id/classify', malwareController.manualClassify);

// IOC endpoints
router.post('/:id/extract-iocs', malwareController.extractIOCs);
router.get('/:id/iocs', malwareController.getIOCs);
router.get('/:id/iocs/export', malwareController.exportIOCs);
router.get('/iocs/search', malwareController.searchIOCs);

// YARA endpoints
router.post('/:id/generate-yara', malwareController.generateYaraRule);
router.get('/yara/rules', malwareController.getYaraRules);
router.get('/yara/rules/:ruleId', malwareController.getYaraRule);
router.post('/yara/rules/:ruleId/test', malwareController.testYaraRule);
router.get('/yara/rules/export', malwareController.exportYaraRules);

module.exports = router;
