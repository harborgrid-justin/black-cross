/**
 * Malware Analysis & Sandbox Module
 * Entry point for the malware analysis module
 */

const express = require('express');
const { connectDatabase } = require('./config/database');
const malwareRoutes = require('./routes/malwareRoutes');
const sandboxRoutes = require('./routes/sandboxRoutes');
const logger = require('./utils/logger');

const router = express.Router();

/**
 * Initialize the malware analysis module
 */
async function initialize() {
  try {
    // Connect to database
    await connectDatabase();
    logger.info('Malware Analysis module initialized');
  } catch (error) {
    logger.error('Failed to initialize Malware Analysis module:', error);
    throw error;
  }
}

// Mount routes
router.use('/malware', malwareRoutes);
router.use('/sandbox', sandboxRoutes);

module.exports = {
  router,
  initialize,
};
